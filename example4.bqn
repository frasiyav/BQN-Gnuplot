âŸ¨GnuplotâŸ© â† â€¢Import "Gnuplot.bqn"

âŸ¨s,r,bâŸ©â† âŸ¨10,30,8Ã·3âŸ©
F â† {ğ•ŠâŸ¨x,y,zâŸ©: âŸ¨sÃ—y-x,y-ËœxÃ—r-z,(xÃ—y)-bÃ—zâŸ©}
_run â† {stepsâ€¿dt ğ”½ _ğ•£ i: (âŠ£+dtÃ—ğ”½âˆ˜âŠ£)`âŒ¾(<Ë˜)iâˆ¾stepsâ€¿(â‰ i)â¥Š0â€¿0â€¿0}
data â† 10000â€¿0.01 F _run 1â€¿2â€¿3

plt â† Gnuplot "
  terminal pngcairo size 1440,900
  output 'example4-output.png'
  title 'Lorenz Atrractor'
  multiplot layout 1,2 margins 0.12, 0.9, 0.18, 0.9 spacing 0.20,0.15 title 'Taken''s Theorem'
  view 70,30
  zrange [0:70]
  xyplane at 0
  xlabel 'X'
  ylabel 'Y'
  zlabel 'Z'
"
plt.Unset "
  key
  colorbox
  xtics
  ytics
  ztics
"

plt.SPlot dataâ€¿"using 1:2:3:0 with lines lc palette"
plt.Subplot "
  title 'Reconstruction'
  zrange [-30:40]
  xyplane at -30
  xlabel 'X(t)'
  ylabel 'X(t-o)'
  zlabel 'X(t-2o)'
"

Reconstruct â† {ğ•Šğ•©:1ğ•Šğ•©; offsetğ•Šğ•©:(2Ã—offset)â†“â‰>Â»âŸ(ğ•¨Ã—â†•3)ğ•©}
rec â† 7 Reconstruct âŠ‘Ë˜ data

plt.Splot recâ€¿"using 1:2:3:0 with lines lc palette"

plt.Show @

