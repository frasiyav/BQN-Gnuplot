Gnuplotpipe â† {ğ•Šğ•©:
  popen â† @ â€¢FFI âŸ¨"*:i32","popen","*i32:c8","*i32:c8"âŸ©
  fputs â† @ â€¢FFI âŸ¨"i32","fputs","*i32:c8","*:i32"âŸ©
  pclose â† @ â€¢FFI âŸ¨"i32", "pclose",">*:i32"âŸ©
  fp â† POpen âŸ¨"gnuplot --persist"âˆ¾@,"w"âˆ¾@âŸ©
  FPuts âŸ¨ğ•©âˆ¾@,fpâŸ©
  PClose fp
}

lf â† @+10
IsStr  â† (1==)â—¶0â€¿(âˆ§Â´2=â€¢TypeÂ¨)
AssertStr â† ("Expected string, got: "âˆ¾â€¢Repr)!IsStr
Split â† (âŠ¢-Ëœ+`Ã—Â¬)âˆ˜=âŠ”âŠ¢
Join â† {âˆ¾1â†“â¥Š(<ğ•¨)â‰Ë˜ğ•©}
Replace â† {aâ€¿bğ•Šğ•©: bÂ¨âŒ¾((a=ğ•©)âŠ¸/)ğ•©}
FmtData â† ("Â¯-"Replace ' 'Join â€¢ReprÂ¨)Â¨ <Ë˜âŸ(1<=)
Clean â† """'" Replace ((âˆ¨`âˆ§âˆ¨`âŒ¾âŒ½)' 'âŠ¸â‰ )âŠ¸/

Gnuplot â‡ {ğ•Š options:

  ParseList â† {ğ•Š@:""; CleanÂ¨âˆ¾Â´âš‡Â¯1(0â‰ â‰ Â¨)âŠ¸/(lf Split AssertStrâŠ¸âŠ¢)âš‡1ğ•©}

  Plt â† {

    setsâ€¿unsetsâ€¿fnsâ€¿sfnsâ€¿data â† 5/â‹ˆâŸ¨âŸ©

    S  â‡ {sets  âˆ¾â†©   "set "âŠ¸âˆ¾Â¨ParseList ğ•©} â‹„ S ğ•©
    US â‡ {unsetsâˆ¾â†© "unset "âŠ¸âˆ¾Â¨ParseList ğ•©}

    Add â† (âˆ¾âŸœ<Â¨)âŸœ{
      ğ•Šfâ€¿o:
        Â¬1â€¿1â‰¡â€¢TypeÂ¨ğ•©?
          AssertStr o
          âˆ¾âŸœ(' 'âˆ¾o)âŒ¾âŠ‘ğ•Šf;
          ğ•Šaâ€¿b: "'-'"â€¿ğ•©;
      IsStr ğ•©?
        â‹ˆâŸœâŸ¨âŸ©ğ•©;
        "Data not flat"!(3âŒŠâ‰¡)â—¶âŸ¨0,1,âˆ§Â´Â·â¥ŠIsStrÂ¨âˆ¨Â·Â¬â‰¡Â¨,0âŸ©ğ•©
        "Data rank > 2" !2â‰¥=ğ•©
        "'-'"â‹ˆğ•©
    }

    E â† "Mixing Plot and SPlot"!Â·Â¬â‰ 
    P  â‡ {E sfns â‹„ fnsâ€¿data Addâ†©ğ•©}
    SP â‡ {E fns â‹„ sfnsâ€¿data Addâ†©ğ•©}

    Fmt â‡ {ğ•¤â‹„âˆ¾âŸ¨
      setsâˆ¾unsets
      <âˆ¾"plot "â€¿"splot "(âŠ£âˆ¾âŸ(Ã—â‰ âˆ˜âŠ¢)", " Join âŠ¢)Â¨fnsâ€¿sfns
      âˆ¾(FmtDataâˆ¾Â·<"e"Ë™)Â¨(0â‰ â‰ Â¨)âŠ¸/data
    âŸ©}
  }
  
  plts â† âŸ¨Plt optionsâŸ©
  SubPlot â‡ {pltsâˆ¾â†© Plt ğ•©}
  Plot    â‡ {(âŠ¢Â´plts).P  ğ•©}
  SPlot   â‡ {(âŠ¢Â´plts).SP ğ•©}
  Set     â‡ {(âŠ¢Â´plts).S  ğ•©}
  UnSet   â‡ {(âŠ¢Â´plts).US ğ•©}

  Format â† lf Join Â·âˆ¾{ğ•©.Fmt @}Â¨
  Show  â‡ {ğ•¤â‹„ Gnuplotpipe lfâˆ¾ËœFormat plts}
  Debug â‡ {ğ•¤â‹„ â€¢Show Format plts}
}
